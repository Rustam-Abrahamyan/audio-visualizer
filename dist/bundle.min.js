!function(e){function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(n){return e[n]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,t){"use strict";var i=Math.PI;t.r(n);var r=function(){function e(e){let n=[];for(let a,l=0;l<e.length;l++)a=i+(r-i)*(l/e.length),n[l]=Math.max(t(e[l]/o,a)*o,1);return n}function n(e){return t(e,2.55)}var t=Math.pow;let i=5,r=3,o=255;return{GetVisualBins:function(t,i,r,o){let a=i,l=[],d=[],c=0;for(let e,t=0;t<a;t++)e=Math.round(n(t/a)*(o-r)+r),e<=c&&(e=c+1),c=e,l[t]=e;let s=[];for(let e=0;e<a;e++){let n=l[e],i=l[e+1];null==i&&(i=o);let r=t[n],a=n,d=i-n;for(let e,i=1;i<d;i++)e=n+i,t[e]>r&&(r=t[e],a=e);s[e]=a}for(let e=0;e<a;e++){let n=s[e],i=s[e-1];null==i&&(i=r);let o=t[i],a=t[n];d[e]=(o+a)/2,isNaN(d[e])&&(d[e]=0)}return e(d)}}},o=function(){let e,n,t,i,o,a,l,d,c,s,u;return{name:"Theme-1",init:function(e,n){i=e.analyser,o=n,a=n.scene},make:function(){t=new THREE.Object3D,u=new r,i.fftSize=4096,l=i.frequencyBinCount,d=new Uint8Array(l),o.useOrthographicCamera(),n=-640;for(let i=0;i<64;i++){e=new THREE.PlaneBufferGeometry(18,5,1);let i=new THREE.ShaderMaterial({uniforms:{},vertexShader:"\n        void main() {\n            gl_Position = gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n    ",fragmentShader:"\n        void main() {\n            gl_FragColor = vec4( gl_FragCoord.y/100.0, gl_FragCoord.y/300.0, gl_FragCoord.y/500.0, 1.0 );\n        }\n    "});s=new THREE.Mesh(e,i),s.position.x=n,n+=20,t.add(s)}a.add(t)},destroy:function(){a.remove(t)},render:function(){if(i.getByteFrequencyData(d),c=u.GetVisualBins(d,64,4,1300),t)for(let e=0;e<c.length;e++)t.children[e].geometry.attributes.position.array[1]=c[e],t.children[e].geometry.attributes.position.array[4]=c[e],t.children[e].geometry.attributes.position.needsUpdate=!0}}},a=function(){function e(e,n){let i=function(e,n){return(e%n+n)%n}(250-2.2*n,360);t.children[e].material.uniforms.col.value=new THREE.Color("hsl("+i+", 100%, 50%)")}let n,t,o,a,l,d,c,s,u,m,h=128;return{name:"Theme-2",init:function(e,n){o=e.analyser,a=n,l=n.scene},make:function(){t=new THREE.Object3D,m=new r,o.fftSize=4096,d=o.frequencyBinCount,c=new Uint8Array(d),a.usePerspectiveCamera(),a.camera.position.y=0,a.camera.position.z=250;for(let e=0;e<64;e++){let r={col:{type:"c",value:new THREE.Color("hsl(287,100%,54%)")}},o=new THREE.ShaderMaterial({uniforms:r,vertexShader:"\n        varying vec4 pos;\n        void main() {\n            pos = modelViewMatrix * vec4( position, 1.0 );\n           gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n       }\n    ",fragmentShader:"\n        uniform vec3 col;\n        varying vec4 pos;\n        void main() {\n            gl_FragColor = vec4( -pos.z/180.0 * col.r, -pos.z/180.0 * col.g, -pos.z/180.0 * col.b, 1.0 );\n        }\n    "});n=new THREE.PlaneBufferGeometry(3,500,1),n.rotateX(i/1.8),n.applyMatrix((new THREE.Matrix4).makeTranslation(0,60,0)),u=new THREE.Mesh(n,o),u.rotation.z=e*(2*i/h)+i/h,t.add(u),n=new THREE.PlaneBufferGeometry(3,500,1),n.rotateX(i/1.8),n.applyMatrix((new THREE.Matrix4).makeTranslation(0,60,0)),u=new THREE.Mesh(n,o),u.rotation.z=2*i/h*-e-i/h,t.add(u)}l.add(t)},destroy:function(){l.remove(t)},render:function(){o.getByteFrequencyData(c);let n=function(e){let n=0;for(let t=0;t<e.length;t++)n+=e[t];return n/e.length}(c);if(s=m.GetVisualBins(c,h,4,1300),t)for(let i=0;i<s.length/2;i++)e(2*i,n),t.children[2*i].geometry.attributes.position.array[7]=s[i]/2+(65+n/1.5),t.children[2*i].geometry.attributes.position.array[10]=s[i]/2+(65+n/1.5),t.children[2*i].geometry.attributes.position.needsUpdate=!0,t.children[2*i+1].geometry.attributes.position.array[7]=s[i]/2+(65+n/1.5),t.children[2*i+1].geometry.attributes.position.array[10]=s[i]/2+(65+n/1.5),t.children[2*i+1].geometry.attributes.position.needsUpdate=!0}}},l=function(){function e(e,n){let i=function(e,n){return(e%n+n)%n}(250-.9*n,360);t.children[e].children[0].material.uniforms.col.value=new THREE.Color("hsl("+i+", 90%, "+(100-Math.min(40,parseInt(n)))+"%)")}let n,t,o,a,l,d,c,s,u,m,h,f,p,w,y,g,v,E=0,C="\n        void main() {\n            gl_Position = gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n    ",x={name:"Theme-3",init:function(e,n){d=e,c=e.analyser,s=n,u=n.scene},make:function(){for(t=new THREE.Object3D,g=new r,c.fftSize=4096,m=c.frequencyBinCount,h=new Uint8Array(m),s.usePerspectiveCamera(),s.camera.position.x=0,s.camera.position.y=0,s.camera.position.z=0;s.container.firstChild;)s.container.removeChild(s.container.firstChild);s.renderer=new THREE.WebGLRenderer({alpha:!0,preserveDrawingBuffer:!0}),s.renderer.setPixelRatio(window.devicePixelRatio),s.renderer.setSize(window.innerWidth,window.innerHeight),s.container.appendChild(s.renderer.domElement),s.renderer.setClearColor(new THREE.Color(16645629),1),s.renderer.clear(),s.renderer.autoClearColor=!1;let e=3;for(let i=0;i<512;i++){n=new THREE.CircleBufferGeometry(10,6),v={col:{type:"c",value:new THREE.Color("hsl(240, 100%, 50%)")}};let i=new THREE.ShaderMaterial({uniforms:v,vertexShader:C,fragmentShader:"\n        uniform vec3 col;\n        void main() {\n            gl_FragColor = vec4( col.r, col.g, col.b, 1.0 );\n        }\n    ",side:THREE.DoubleSide});p=new THREE.Mesh(n,i),p.position.x=e,p.position.y=0,p.position.z=-50,e+=.12;let r=new THREE.Object3D;r.add(p),t.add(r)}u.add(t),o=t.clone(),o.rotation.z=i,u.add(o),a=t.clone(),a.rotation.z=i,u.add(a),l=t.clone(),u.add(l),n=new THREE.PlaneBufferGeometry(2e3,2e3,1,1);let d=new THREE.ShaderMaterial({uniforms:v,vertexShader:C,fragmentShader:"\n        void main() {\n            gl_FragColor = vec4( 1.0, 1.0, 1.0, 0.2 );\n        }\n    ",transparent:!0,depthWrite:!1});w=new THREE.Mesh(n,d),w.position.x=0,w.position.y=0,w.position.z=-60,u.add(w)},destroy:function(){for(u.remove(t),u.remove(o),u.remove(a),u.remove(l),u.remove(w);s.container.firstChild;)s.container.removeChild(s.container.firstChild);s.renderer=new THREE.WebGLRenderer({alpha:!0}),s.renderer.setPixelRatio(window.devicePixelRatio),s.renderer.setSize(window.innerWidth,window.innerHeight),s.container.appendChild(s.renderer.domElement),s.renderer.autoClearColor=!0,s.renderer.setClearColor(new THREE.Color(16777215),0),s.renderer.clear()},reset:function(){if(t)for(let e=0;e<t.children.length;e++)t.children[e].position.y=0,o.children[e].position.y=0,a.children[e].position.y=0,l.children[e].position.y=0},render:function(){var n=Math.log10;if(d.hasNewSong&&x.reset(),c.getByteFrequencyData(h),f=h,f=g.GetVisualBins(h,512,6,1300),y=function(e){let n=0;for(let t=0;t<e.length;t++)n+=e[t];return n/e.length}(h),y=(y+E)/2,t)for(let i=0;i<f.length;i++)t.children[i].children[0].scale.x=1>=f[i]?1e-4:4*n(1+f[i]/255/7),t.children[i].children[0].scale.y=1>=f[i]?1e-4:4*n(1+f[i]/255/7),o.children[i].children[0].scale.x=1>=f[i]?1e-4:4*n(1+f[i]/255/7),o.children[i].children[0].scale.y=1>=f[i]?1e-4:4*n(1+f[i]/255/7),a.children[i].children[0].scale.x=1>=f[i]?1e-4:4*n(1+f[i]/255/7),a.children[i].children[0].scale.y=1>=f[i]?1e-4:4*n(1+f[i]/255/7),l.children[i].children[0].scale.x=1>=f[i]?1e-4:4*n(1+f[i]/255/7),l.children[i].children[0].scale.y=1>=f[i]?1e-4:4*n(1+f[i]/255/7),t.children[i].position.y+=1>=f[i]?1e-4:4*n(1+f[i]/255/7),o.children[i].position.y+=1>=f[i]?1e-4:4*n(1+f[i]/255/7),a.children[i].position.y-=1>=f[i]?1e-4:4*n(1+f[i]/255/7),l.children[i].position.y-=1>=f[i]?1e-4:4*n(1+f[i]/255/7),(30<t.children[i].position.y||1>=y)&&(t.children[i].position.y=0),(30<o.children[i].position.y||1>=y)&&(o.children[i].position.y=0),(-30>a.children[i].position.y||1>=y)&&(a.children[i].position.y=0),(-30>l.children[i].position.y||1>=y)&&(l.children[i].position.y=0),e(i,f[i]);E=y}};return x};if((()=>{try{const e=document.createElement("canvas"),n=e.getContext("webgl")||e.getContext("experimental-webgl");return!(!window.WebGLRenderingContext||!n)}catch(e){return!1}})()){const e=new function(){function e(){n.source.connect(n.analyser),n.source.connect(n.gainNode),n.gainNode.connect(n.audioCtx.destination),n.source.start(0),n.hasNewSong=!1}const n={audioCtx:null,source:null,analyser:null,gainNode:null,hasNewSong:!1,init(){n.audioCtx=new(window.AudioContext||window.webkitAudioContext),n.analyser=n.audioCtx.createAnalyser(),n.gainNode=n.audioCtx.createGain(),n.gainNode.gain.value=.2},makeAudio(t){n.source&&n.source.stop(0),n.source=n.audioCtx.createBufferSource(),n.audioCtx.decodeAudioData?n.audioCtx.decodeAudioData(t,(function(t){n.source.buffer=t,e()})):(n.source.buffer=n.audioCtx.createBuffer(t,!1),e()),n.hasNewSong=!0}};return n},n=new function(){const e=["Eminem - Lose Yourself.mp3"];return{filename:null,init(n){document.body.addEventListener("drop",(function(e){e.preventDefault();let i=e.target.files||e.dataTransfer.files;t.innerText=i[0].name.replace(/\.[^/.]+$/,"");let r=new FileReader;r.onload=function(e){document.getElementById("instructions")&&document.getElementById("instructions").remove(),document.getElementById("warning")&&document.getElementById("warning").remove();let t=e.target.result;n.makeAudio(t)},r.readAsArrayBuffer(i[0])}),!1),document.body.addEventListener("dragover",(function(e){e.preventDefault()}),!1);let t=document.createElement("div");t.setAttribute("id","audioname"),document.body.appendChild(t);let i=document.createElement("div");i.setAttribute("id","instructions");let r=document.createElement("div");r.innerText="drop an .m",i.appendChild(r);let o=document.createElement("div");o.setAttribute("id","defaultsong"),o.innerText="or play default",i.appendChild(o),document.body.appendChild(i),document.getElementById("defaultsong").addEventListener("click",()=>{let i=e[parseInt(Math.random()*e.length)],r=new XMLHttpRequest;r.open("GET","songs/"+i,!0),r.responseType="arraybuffer",t.innerText="[ Loading ]",r.onload=()=>{t.innerText=i.replace(/\.[^/.]+$/,""),document.getElementById("instructions")&&document.getElementById("instructions").remove(),document.getElementById("warning")&&document.getElementById("warning").remove(),n.makeAudio(r.response)},r.send()})}}},t=new function(){function e(){i=window.innerWidth/2,r=window.innerHeight/2,o.camera.aspect=window.innerWidth/window.innerHeight,o.camera.updateProjectionMatrix(),o.renderer.setSize(window.innerWidth,window.innerHeight)}function n(){setTimeout((function(){requestAnimationFrame(n)}),1e3/60),o.renderVisualization&&o.renderVisualization(),o.renderer.render(o.scene,o.camera)}let t,i=window.innerWidth/2,r=window.innerHeight/2,o={scene:null,renderer:null,camera:null,container:null,init:function(i){t=i,o.container=document.createElement("div"),o.container.width="100%",o.container.height="100%",document.body.appendChild(o.container),o.camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,1e3),o.camera.position.y=150,o.camera.position.z=500,o.scene=new THREE.Scene,o.renderer=new THREE.WebGLRenderer({alpha:!0,preserveDrawingBuffer:!0}),o.renderer.setPixelRatio(window.devicePixelRatio),o.renderer.setSize(window.innerWidth,window.innerHeight),o.container.appendChild(o.renderer.domElement),window.addEventListener("resize",e,!1),n()},usePerspectiveCamera:function(){o.camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,.01,2e3),o.camera.position.y=150,o.camera.position.z=500},useOrthographicCamera:function(){o.camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,1e3),o.camera.position.y=150,o.camera.position.z=500},renderVisualization:null};return o},i=new function(){let e,n,t,i={visualizers:{"Theme-1":new o,"Theme-2":new a,"Theme-3":new l},activeViz:null,init:function(r,o){e=r,n=o,t=o.scene;let a=document.createElement("div");a.setAttribute("id","selector"),document.body.appendChild(a);let l=document.createElement("ul");a.appendChild(l);let d=Object.keys(i.visualizers);for(let e,n=0;n<d.length;n++)e=document.createElement("li"),e.innerText=d[n],e.setAttribute("id","vis_"+d[n]),e.setAttribute("class","visualizer"),l.appendChild(e);document.querySelectorAll(".visualizer").forEach(t=>{i.visualizers.hasOwnProperty(t.innerText)&&i.visualizers[t.innerText].init(e,n),t.addEventListener("click",()=>{[...t.parentElement.children].forEach(e=>e.classList.remove("active")),t.classList.add("active");let e=t.innerText;(!i.activeViz||i.activeViz.name!=e)&&i.visualizers.hasOwnProperty(e)&&(i.activeViz&&i.activeViz.destroy(),i.activeViz=i.visualizers[e],i.activeViz.make(),o.renderVisualization=i.activeViz.render)})}),document.getElementById("vis_Theme-1").click()}};return i};e.init(),n.init(e),t.init(e),i.init(e,t)}else alert("Your browser doesn't appear to support the HTML5 canvas element.")}]);